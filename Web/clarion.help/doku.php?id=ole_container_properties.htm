<!DOCTYPE html>
<html lang="en" dir="ltr" class="no-js">
<head>
    <meta charset="utf-8" />
    <title>ole_container_properties.htm [Clarion Community Help]</title>
    <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
    <meta name="generator" content="DokuWiki"/>
<meta name="theme-color" content="#008800"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="ole_container_properties.htm"/>
<link rel="search" type="application/opensearchdescription+xml" href="/lib/exe/opensearch.php" title="Clarion Community Help"/>
<link rel="start" href="/"/>
<link rel="contents" href="/doku.php?id=ole_container_properties.htm&amp;do=index" title="Sitemap"/>
<link rel="manifest" href="/lib/exe/manifest.php"/>
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="/feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current namespace" href="/feed.php?mode=list&amp;ns="/>
<link rel="alternate" type="text/html" title="Plain HTML" href="/doku.php?do=export_xhtml&amp;id=ole_container_properties.htm"/>
<link rel="alternate" type="text/plain" title="Wiki Markup" href="/doku.php?do=export_raw&amp;id=ole_container_properties.htm"/>
<link rel="canonical" href="http://clarion.help/doku.php?id=ole_container_properties.htm"/>
<link rel="stylesheet" type="text/css" href="/lib/exe/css.php?t=dokuwiki&amp;tseed=6c87f37cf2e26d7e09fa69b644b48db6"/>
<!--[if gte IE 9]><!-->
<script type="text/javascript">/*<![CDATA[*/var NS='';var JSINFO = {"id":"ole_container_properties.htm","namespace":"","ACT":"show","useHeadingNavigation":0,"useHeadingContent":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/jquery.php?tseed=23f888679b4f1dc26eef34902aca964f"></script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/js.php?t=dokuwiki&amp;tseed=6c87f37cf2e26d7e09fa69b644b48db6"></script>
<!--<![endif]-->
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="shortcut icon" href="/lib/tpl/dokuwiki/images/favicon.ico" />
<link rel="apple-touch-icon" href="/lib/tpl/dokuwiki/images/apple-touch-icon.png" />
    </head>

<body>
    <div id="dokuwiki__site"><div id="dokuwiki__top" class="site dokuwiki mode_show tpl_dokuwiki     ">

        
<!-- ********** HEADER ********** -->
<div id="dokuwiki__header"><div class="pad group">

    
    <div class="headings group">
        <ul class="a11y skip">
            <li><a href="#dokuwiki__content">skip to content</a></li>
        </ul>

        <h1><a href="/doku.php?id=start"  accesskey="h" title="[H]"><img src="/lib/exe/fetch.php?media=logo.png" width="354" height="103" alt="" /> <span>Clarion Community Help</span></a></h1>
            </div>

    <div class="tools group">
        <!-- USER TOOLS -->
                    <div id="dokuwiki__usertools">
                <h3 class="a11y">User Tools</h3>
                <ul>
                    <li class="action login"><a href="/doku.php?id=ole_container_properties.htm&amp;do=login&amp;sectok=" title="Log In" rel="nofollow"><span>Log In</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M10 17.25V14H3v-4h7V6.75L15.25 12 10 17.25M8 2h9a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2v-4h2v4h9V4H8v4H6V4a2 2 0 0 1 2-2z"/></svg></a></li>                </ul>
            </div>
        
        <!-- SITE TOOLS -->
        <div id="dokuwiki__sitetools">
            <h3 class="a11y">Site Tools</h3>
            <form action="/doku.php?id=start" method="get" role="search" class="search doku_form" id="dw__search" accept-charset="utf-8"><input type="hidden" name="do" value="search" /><input type="hidden" name="id" value="ole_container_properties.htm" /><div class="no"><input name="q" type="text" class="edit" title="[F]" accesskey="f" placeholder="Search" autocomplete="on" id="qsearch__in" value="" /><button value="1" type="submit" title="Search">Search</button><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>            <div class="mobileTools">
                <form action="/doku.php" method="get" accept-charset="utf-8"><div class="no"><input type="hidden" name="id" value="ole_container_properties.htm" /><select name="do" class="edit quickselect" title="Tools"><option value="">Tools</option><optgroup label="Page Tools"><option value="edit">Show pagesource</option><option value="revisions">Old revisions</option><option value="backlink">Backlinks</option></optgroup><optgroup label="Site Tools"><option value="recent">Recent Changes</option><option value="media">Media Manager</option><option value="index">Sitemap</option></optgroup><optgroup label="User Tools"><option value="login">Log In</option></optgroup></select><button type="submit">&gt;</button></div></form>            </div>
            <ul>
                <li class="action recent"><a href="/doku.php?id=ole_container_properties.htm&amp;do=recent" title="Recent Changes [r]" rel="nofollow" accesskey="r">Recent Changes</a></li><li class="action media"><a href="/doku.php?id=ole_container_properties.htm&amp;do=media&amp;ns=" title="Media Manager" rel="nofollow">Media Manager</a></li><li class="action index"><a href="/doku.php?id=ole_container_properties.htm&amp;do=index" title="Sitemap [x]" rel="nofollow" accesskey="x">Sitemap</a></li>            </ul>
        </div>

    </div>

    <!-- BREADCRUMBS -->
            <div class="breadcrumbs">
                                        <div class="trace"><span class="bchead">Trace:</span> <span class="bcsep">•</span> <bdi><a href="/doku.php?id=ddepoke_send_unsolicited_data_to_dde_server_.htm"  class="breadcrumbs" title="ddepoke_send_unsolicited_data_to_dde_server_.htm">ddepoke_send_unsolicited_data_to_dde_server_.htm</a></bdi> <span class="bcsep">•</span> <bdi><a href="/doku.php?id=ddequery_return_registered_dde_servers_.htm"  class="breadcrumbs" title="ddequery_return_registered_dde_servers_.htm">ddequery_return_registered_dde_servers_.htm</a></bdi> <span class="bcsep">•</span> <bdi><a href="/doku.php?id=dderead_get_data_from_dde_server_.htm"  class="breadcrumbs" title="dderead_get_data_from_dde_server_.htm">dderead_get_data_from_dde_server_.htm</a></bdi> <span class="bcsep">•</span> <bdi><a href="/doku.php?id=ddeserver_return_dde_server_channel_.htm"  class="breadcrumbs" title="ddeserver_return_dde_server_channel_.htm">ddeserver_return_dde_server_channel_.htm</a></bdi> <span class="bcsep">•</span> <bdi><a href="/doku.php?id=ddetopic_return_server_topic_.htm"  class="breadcrumbs" title="ddetopic_return_server_topic_.htm">ddetopic_return_server_topic_.htm</a></bdi> <span class="bcsep">•</span> <bdi><a href="/doku.php?id=ddevalue_return_data_value_sent_to_server_.htm"  class="breadcrumbs" title="ddevalue_return_data_value_sent_to_server_.htm">ddevalue_return_data_value_sent_to_server_.htm</a></bdi> <span class="bcsep">•</span> <bdi><a href="/doku.php?id=ddewrite_provide_data_to_dde_client_.htm"  class="breadcrumbs" title="ddewrite_provide_data_to_dde_client_.htm">ddewrite_provide_data_to_dde_client_.htm</a></bdi> <span class="bcsep">•</span> <bdi><a href="/doku.php?id=object_linking_and_embedding.htm"  class="breadcrumbs" title="object_linking_and_embedding.htm">object_linking_and_embedding.htm</a></bdi> <span class="bcsep">•</span> <bdi><a href="/doku.php?id=ole_overview.htm"  class="breadcrumbs" title="ole_overview.htm">ole_overview.htm</a></bdi> <span class="bcsep">•</span> <span class="curid"><bdi><a href="/doku.php?id=ole_container_properties.htm"  class="breadcrumbs" title="ole_container_properties.htm">ole_container_properties.htm</a></bdi></span></div>
                    </div>
    


    <hr class="a11y" />
</div></div><!-- /header -->

        <div class="wrapper group">

            
            <!-- ********** CONTENT ********** -->
            <div id="dokuwiki__content"><div class="pad group">
                
                <div class="pageId"><span>ole_container_properties.htm</span></div>

                <div class="page group">
                                                            <!-- wikipage start -->
                    <div class="table sectionedit1"><table class="inline">
	<tr class="row0">
		<td class="col0"> <strong>Navigation:</strong>  <a href="/doku.php?id=introduction.htm" class="wikilink1" title="introduction.htm">Language Reference</a> &gt; App A - DDE, OLE, and OCX &gt; Object Linking and Embedding &gt;====== OLE Container Properties ====== </td><td class="col1"> <a href="/doku.php?id=ole_overview.htm" class="media" title="ole_overview.htm"><img src="/lib/exe/fetch.php?media=btn_prev_n.gif" class="media" title="Previous page" alt="Previous page" /></a><a href="/doku.php?id=introduction.htm" class="media" title="introduction.htm"><img src="/lib/exe/fetch.php?media=btn_home_n.gif" class="media" title="Return to chapter overview" alt="Return to chapter overview" /></a><a href="/doku.php?id=oledirectory_get_list_of_installed_ole_ocx_.htm" class="media" title="oledirectory_get_list_of_installed_ole_ocx_.htm"><img src="/lib/exe/fetch.php?media=btn_next_n.gif" class="media" title="Next page" alt="Next page" /></a> </td>
	</tr>
	<tr class="row1">
		<td class="col0 leftalign" colspan="2">  </td>
	</tr>
</table></div>

<p>
<em class="u"><strong>Contents:</strong></em>
</p>

<p>
<span class="curid"><a href="/doku.php?id=ole_container_properties.htm#oleattributeprops" class="wikilink1" title="ole_container_properties.htm">Attribute Properties</a></span>
</p>

<p>
<span class="curid"><a href="/doku.php?id=ole_container_properties.htm#oleundeclaredprops" class="wikilink1" title="ole_container_properties.htm">Undeclared Properties</a></span>
</p>

<p>
<span class="curid"><a href="/doku.php?id=ole_container_properties.htm#oleexampleprogram" class="wikilink1" title="ole_container_properties.htm">Example Program</a></span>
</p>

<p>
<span class="curid"><a href="/doku.php?id=ole_container_properties.htm#oleinterfaceprops" class="wikilink1" title="ole_container_properties.htm">Interface Properties</a></span>
</p>

<p>
<span class="curid"><a href="/doku.php?id=ole_container_properties.htm#oleclarion_ole_ocx_library_and_object_hierarchies" class="wikilink1" title="ole_container_properties.htm">Clarion OLE/OCX library and object hierarchies</a></span>
</p>

<p>
There are a number of properties associated with an OLE container control that deal only with OLE objects (not .OCX controls).
</p>

<p>
<strong>Attribute Properties</strong>
</p>
<div class="table sectionedit2"><table class="inline">
	<tr class="row0">
		<td class="col0"> PROP:Create </td><td class="col1"> The CREATE attribute (blank if none). (WRITE ONLY) </td>
	</tr>
	<tr class="row1">
		<td class="col0"> PROP:Open </td><td class="col1"> The OPEN attribute (blank if none). (WRITE ONLY) </td>
	</tr>
	<tr class="row2">
		<td class="col0"> PROP:Document </td><td class="col1"> The DOCUMENT attribute (blank if none). (WRITE ONLY) </td>
	</tr>
	<tr class="row3">
		<td class="col0"> PROP:Link </td><td class="col1"> The LINK attribute (blank if none). (WRITE ONLY) </td>
	</tr>
	<tr class="row4">
		<td class="col0"> PROP:Clip </td><td class="col1"> The CLIP attribute. A toggle attribute. Assigning a null string (<code>) or zero turns it off, and &#039;1&#039; or 1 turns it on. (WRITE ONLY) |
| PROP:Stretch | The STRETCH attribute. A toggle attribute. Assigning a null string (</code>) or zero turns it off, and &#039;1&#039; or 1 turns it on. (WRITE ONLY) </td>
	</tr>
	<tr class="row5">
		<td class="col0"> PROP:Autosize </td><td class="col1"> The AUTOSIZE attribute. A toggle attribute. Assigning a null string (<code>) or zero turns it off, and &#039;1&#039; or 1 turns it on. (WRITE ONLY) |
| PROP:Zoom | The ZOOM attribute. A toggle attribute. Assigning a null string (</code>) or zero turns it off, and &#039;1&#039; or 1 turns it on. (WRITE ONLY) </td>
	</tr>
	<tr class="row6">
		<td class="col0"> PROP:Compatibility </td><td class="col1"> The COMPATIBILITY attribute (blank if none). (WRITE ONLY) </td>
	</tr>
</table></div>

<p>
<strong>Undeclared Properties</strong>
</p>
<div class="table sectionedit3"><table class="inline">
	<tr class="row0">
		<td class="col0" colspan="5"> PROP:Blob </td><td class="col5"> Convert an object to and from a blob. (READ/WRITE) </td>
	</tr>
	<tr class="row1">
		<td class="col0" colspan="5"> PROP:SaveAs </td><td class="col5"> Saves the object to an OLE Compound Storage file. (WRITE ONLY) The syntax for placing the object in the file is &#039;<em>filename</em>\!<em>component</em>&#039; For example: </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign" colspan="5">  </td><td class="col5"> <strong>?controlx{PROP:SaveAs} = &#039;myfile\!objectx&#039;</strong> </td>
	</tr>
	<tr class="row3">
		<td class="col0" colspan="5"> PROP:DoVerb </td><td class="col5"> Executes an OLE doverb command from the following set of commands (WRITE ONLY): </td>
	</tr>
	<tr class="row4">
		<td class="col0 leftalign">  </td><td class="col1"> DOVERB:Primary (0) </td><td class="col2"> Calls the object&#039;s primary action. The object, not the container, determines this action. If the object supports in-place activation, the primary verb usually activates the object in-place. </td><td class="col3"> <br/>
</td><td class="col4"> <br/>
</td><td class="col5"></td>
	</tr>
	<tr class="row5">
		<td class="col0 leftalign">  </td><td class="col1"> DOVERB:Show (-1) </td><td class="col2"> Tells the object to show itself for editing or viewing. Called to display newly inserted objects for initial editing and to show link sources. This is usually an alias for some other object-defined action. </td><td class="col3"> <br/>
</td><td class="col4"> <br/>
</td><td class="col5"></td>
	</tr>
	<tr class="row6">
		<td class="col0 leftalign">  </td><td class="col1"> DOVERB:Open (-2) </td><td class="col2"> Tells the object to open itself for editing in a separate window from its container (this includes objects that support in-place activation). If the object does not support in-place activation, this has the same action as DOVERB:Show. </td><td class="col3"> <br/>
</td><td class="col4"> <br/>
</td><td class="col5"></td>
	</tr>
	<tr class="row7">
		<td class="col0 leftalign">  </td><td class="col1"> DOVERB:Hide (-3) </td><td class="col2"> Tells the object to remove its user interface. This applies only to objects activated in-place. </td><td class="col3"> <br/>
</td><td class="col4"> <br/>
</td><td class="col5"></td>
	</tr>
	<tr class="row8">
		<td class="col0 leftalign">  </td><td class="col1"> DOVERB:UIActivate (-4) </td><td class="col2"> Activates the object in place, along with its full set of user-interface tools, including menus, toolbars, and its name in the title bar of the container window. </td><td class="col3"> <br/>
</td><td class="col4"> <br/>
</td><td class="col5"></td>
	</tr>
	<tr class="row9">
		<td class="col0 leftalign">  </td><td class="col1"> DOVERB:InPlaceActivate (-5) </td><td class="col2"> Activates the object in-place without displaying the tools (menus and toolbars) that end-users need to change the behavior or appearance of the object. </td><td class="col3"> <br/>
</td><td class="col4"> <br/>
</td><td class="col5"></td>
	</tr>
	<tr class="row10">
		<td class="col0 leftalign">  </td><td class="col1"> DOVERB:DiscardUndoState (-6) </td><td class="col2"> Tells the object to discard any undo state that it may be maintaining without deactivating the object. </td><td class="col3"> <br/>
</td><td class="col4"> <br/>
</td><td class="col5"></td>
	</tr>
	<tr class="row11">
		<td class="col0 leftalign">  </td><td class="col1"> DOVERB:Properties (-7) </td><td class="col2"> Invokes the modal system property browser for the object to allow the user to set its properties. </td><td class="col3"> <br/>
</td><td class="col4"> <br/>
</td><td class="col5"></td>
	</tr>
</table></div>
<div class="table sectionedit4"><table class="inline">
	<tr class="row0">
		<td class="col0"> PROP:Deactivate </td><td class="col1"> Deactivates an in-place active OLE object. (READ/WRITE/EXECUTE) </td>
	</tr>
	<tr class="row1">
		<td class="col0"> PROP:Update </td><td class="col1"> Tells the OLE object to update itself. (READ/WRITE/EXECUTE) </td>
	</tr>
	<tr class="row2">
		<td class="col0"> PROP:CanPaste </td><td class="col1"> Can you paste the object in the clipboard? (READ ONLY) </td>
	</tr>
	<tr class="row3">
		<td class="col0"> PROP:Paste </td><td class="col1"> Pastes an object from the clipboard to an OLE container control. (READ/WRITE/EXECUTE) </td>
	</tr>
	<tr class="row4">
		<td class="col0"> PROP:CanPasteLink </td><td class="col1"> Can the object in the clipboard be pasted as a link? (READ ONLY) </td>
	</tr>
	<tr class="row5">
		<td class="col0"> PROP:PasteLink </td><td class="col1"> Pastes and links an object from the clipboard to an OLE container control. (READ/WRITE/EXECUTE) </td>
	</tr>
	<tr class="row6">
		<td class="col0"> PROP:Copy </td><td class="col1"> Copies an object in an OLE container control to the clipboard. (READ/WRITE/EXECUTE) </td>
	</tr>
	<tr class="row7">
		<td class="col0"> PROP:ReportException </td><td class="col1"> Report OLE exceptions (for debug). (WRITE ONLY) </td>
	</tr>
	<tr class="row8">
		<td class="col0"> PROP:OLE </td><td class="col1"> Is there an OCX or OLE object in the container? (READ ONLY) </td>
	</tr>
	<tr class="row9">
		<td class="col0"> PROP:Language </td><td class="col1"> The number for the language used for OLE Automation or OCX Method. The number for US English is 0409H, and other language numbers can be computed from the data in the WINNT.H file in the MS Windows SDK. (READ/WRITE) </td>
	</tr>
</table></div>

<p>
<strong>Example Program:</strong>
</p>

<p>
<strong> PROGRAM</strong>
</p>

<p>
<strong> MAP</strong>
</p>

<p>
<strong>  INCLUDE(&#039;OCX.CLW&#039;)</strong>
</p>

<p>
<strong>SelectOleServer  PROCEDURE(OleQ PickQ),STRING</strong>
</p>

<p>
<strong> END</strong>
</p>

<p>
<strong> INCLUDE &#039;XL.CLW&#039;          !Constants that Excel uses</strong>
</p>

<p>
<strong> INCLUDE &#039;ERRORS.CLW&#039;      !Include errorcode constants </strong>
</p>

<p>
<strong>SaveLinks  FILE,DRIVER(&#039;TopSpeed&#039;),PRE(SAV),CREATE</strong>
</p>

<p>
<strong>Object     BLOB</strong>
</p>

<p>
<strong>Record     RECORD</strong>
</p>

<p>
<strong>LinkType    STRING(1)      !F = File, B = BLOB</strong>
</p>

<p>
<strong>LinkFile    STRING(64)     !OLE Compound Storage file name and object</strong>
</p>

<p>
<strong>           END</strong>
</p>

<p>
<strong>          END</strong>
</p>

<p>
<strong>i      LONG                !Loop counters</strong>
</p>

<p>
<strong>j      LONG</strong>
</p>

<p>
<strong>ResultQ  QUEUE             !Queue to hold return from OLEDIRECTORY</strong>
</p>

<p>
<strong>Name      CSTRING(64)</strong>
</p>

<p>
<strong>CLSID     CSTRING(64)</strong>
</p>

<p>
<strong>ProgID    CSTRING(64)</strong>
</p>

<p>
<strong>         END</strong>
</p>

<p>
<strong>MainWin WINDOW(&#039;OLE Demo&#039;),AT(,,350,200),STATUS(-1,-1),SYSTEM,GRAY,RESIZE,MAX,TIMER(1)</strong>
</p>

<p>
<strong>         MENUBAR</strong>
</p>

<p>
<strong>          MENU(&#039;&amp;amp;File&#039;)</strong>
</p>

<p>
<strong>           ITEM(&#039;e&amp;amp;xit&#039;),USE(?exit)</strong>
</p>

<p>
<strong>          END</strong>
</p>

<p>
<strong>          MENU(&#039;&amp;amp;Objects&#039;)</strong>
</p>

<p>
<strong>           ITEM(&#039;Create Object&#039;),USE(?CreateObject)</strong>
</p>

<p>
<strong>           ITEM(&#039;Paste Object&#039;),USE(?PasteObject)</strong>
</p>

<p>
<strong>           ITEM(&#039;PasteLink Object&#039;),USE(?PasteLinkObject)</strong>
</p>

<p>
<strong>           ITEM(&#039;Save Object to BLOB&#039;),USE(?SaveObjectBlob),DISABLE</strong>
</p>

<p>
<strong>           ITEM(&#039;Save Object to OLE File&#039;),USE(?SaveObjectFile),DISABLE</strong>
</p>

<p>
<strong>           ITEM(&#039;Retrieve Saved Object&#039;),USE(?GetObject),DISABLE</strong>
</p>

<p>
<strong>          END</strong>
</p>

<p>
<strong>          MENU(&#039;&amp;amp;Activate&#039;)</strong>
</p>

<p>
<strong>           ITEM(&#039;&amp;amp;Spreadsheet&#039;),USE(?ActiveExcel)</strong>
</p>

<p>
<strong>           ITEM(&#039;&amp;amp;Any OLE Object&#039;),USE(?ActiveOLE),DISABLE</strong>
</p>

<p>
<strong>          END</strong>
</p>

<p>
<strong>        END</strong>
</p>

<p>
<strong>       </strong><strong>OLE</strong><strong>,AT(5,10,160,100),COLOR(0808000H),USE(?ExcelObject)</strong>
</p>

<p>
<strong>         MENUBAR</strong>
</p>

<p>
<strong>          MENU(&#039;&amp;amp;Clarion App&#039;)</strong>
</p>

<p>
<strong>           ITEM(&#039;&amp;amp;Deactivate Excel&#039;),USE(?DeactExcel)</strong>
</p>

<p>
<strong>          END</strong>
</p>

<p>
<strong>         END</strong>
</p>

<p>
<strong>       </strong><strong>END</strong>
</p>

<p>
<strong>       </strong><strong>OLE</strong><strong>,AT(170,10,160,100),USE(?AnyOLEObject),AUTOSIZE</strong>
</p>

<p>
<strong>         MENUBAR</strong>
</p>

<p>
<strong>          MENU(&#039;&amp;amp;Clarion App&#039;)</strong>
</p>

<p>
<strong>           ITEM(&#039;&amp;amp;Deactivate Object&#039;),USE(?DeactOLE)</strong>
</p>

<p>
<strong>          END</strong>
</p>

<p>
<strong>         END</strong>
</p>

<p>
<strong>       </strong><strong>END</strong>
</p>

<p>
<strong>       END</strong>
</p>

<p>
<strong> CODE</strong>
</p>

<p>
<strong> OPEN(SaveLinks)           </strong>
</p>

<p>
<strong> IF ERRORCODE()                               !Check for error on Open</strong>
</p>

<p>
<strong>  IF ERRORCODE() = NoFileErr                  !if the file doesn&#039;t exist</strong>
</p>

<p>
<strong>   CREATE(SaveLinks)                          !then create it</strong>
</p>

<p>
<strong>   IF ERRORCODE() THEN HALT(,ERROR()) END</strong>
</p>

<p>
<strong>   OPEN(SaveLinks)                            !then open it for use</strong>
</p>

<p>
<strong>   IF ERRORCODE() THEN HALT(,ERROR()) END</strong>
</p>

<p>
<strong>  ELSE</strong>
</p>

<p>
<strong>   HALT(,ERROR())</strong>
</p>

<p>
<strong>  END</strong>
</p>

<p>
<strong> END</strong>
</p>

<p>
<strong> OPEN(MainWin)</strong>
</p>

<p>
<strong> ?ExcelObject{PROP:Create} = &#039;Excel.Sheet.5&#039;  !Create an Excel spreadsheet object</strong>
</p>

<p>
<strong> DO BuildSheetData                            !populate it with some random data</strong>
</p>

<p>
<strong> IF RECORDS(SaveLinks)                        !Check for existing saved record</strong>
</p>

<p>
<strong>  SET(SaveLinks)                              !and get it</strong>
</p>

<p>
<strong>  NEXT(SaveLinks)</strong>
</p>

<p>
<strong>  POST(EVENT:Accepted,?GetObject)             !and display it</strong>
</p>

<p>
<strong>  DO MenuEnable</strong>
</p>

<p>
<strong> ELSE</strong>
</p>

<p>
<strong>  ADD(SaveLinks)                              !or add blank record</strong>
</p>

<p>
<strong> END</strong>
</p>

<p>
<strong> IF ERRORCODE() THEN HALT(,ERROR()) END</strong>
</p>

<p>
<strong> ACCEPT</strong>
</p>

<p>
<strong>  CASE EVENT()</strong>
</p>

<p>
<strong>  OF EVENT:CloseWindow</strong>
</p>

<p>
<strong>   ?ExcelObject{PROP:Deactivate}             !Deactivate the OLE Server applications</strong>
</p>

<p>
<strong>   ?AnyOLEObject{PROP:Deactivate}</strong>
</p>

<p>
<strong>  OF EVENT:Timer</strong>
</p>

<p>
<strong>   IF CLIPBOARD()</strong>
</p>

<p>
<strong>    IF ?AnyOLEObject{PROP:CanPaste}          !Can Paste object from the clipboard?</strong>
</p>

<p>
<strong>     IF ?PasteObject{PROP:Disable}</strong>
</p>

<p>
<strong>      ENABLE(?PasteObject)</strong>
</p>

<p>
<strong>     END</strong>
</p>

<p>
<strong>    ELSIF NOT ?PasteObject{PROP:Disable}</strong>
</p>

<p>
<strong>     DISABLE(?PasteObject)</strong>
</p>

<p>
<strong>    END</strong>
</p>

<p>
<strong>    IF ?AnyOLEObject{PROP:CanPasteLink}      !Can PasteLink object from clipboard?</strong>
</p>

<p>
<strong>     IF ?PasteLinkObject{PROP:Disable}</strong>
</p>

<p>
<strong>      ENABLE(?PasteLinkObject)</strong>
</p>

<p>
<strong>     END</strong>
</p>

<p>
<strong>    ELSIF NOT ?PasteLinkObject{PROP:Disable}</strong>
</p>

<p>
<strong>     DISABLE(?PasteLinkObject)</strong>
</p>

<p>
<strong>    END</strong>
</p>

<p>
<strong>   END</strong>
</p>

<p>
<strong>  OF EVENT:Accepted</strong>
</p>

<p>
<strong>   CASE FIELD()</strong>
</p>

<p>
<strong>   OF ?Exit</strong>
</p>

<p>
<strong>    POST(EVENT:CloseWindow)</strong>
</p>

<p>
<strong>   OF ?CreateObject</strong>
</p>

<p>
<strong>    OLEDIRECTORY(ResultQ,0)                  !Get a list of installed OLE Servers</strong>
</p>

<p>
<strong>    ?AnyOLEObject{PROP:Create} = SelectOleServer(ResultQ)  !Let the user pick one</strong>
</p>

<p>
<strong>    ?AnyOLEObject{PROP:DoVerb} = 0           !Activate OLE Server in its default mode</strong>
</p>

<p>
<strong>    DO MenuEnable</strong>
</p>

<p>
<strong>   OF ?PasteObject</strong>
</p>

<p>
<strong>    ?AnyOLEObject{PROP:Paste}                !Paste the object </strong>
</p>

<p>
<strong>    SETCLIPBOARD(&#039;Paste Completed&#039;)          !Assign non-object text to clipboard</strong>
</p>

<p>
<strong>    DO MenuEnable</strong>
</p>

<p>
<strong>   OF ?PasteLinkObject        </strong>
</p>

<p>
<strong>    ?AnyOLEObject{PROP:PasteLink}            !PasteLink the object </strong>
</p>

<p>
<strong>    SETCLIPBOARD(&#039;PasteLink Completed&#039;)      !Assign non-object text to clipboard</strong>
</p>

<p>
<strong>    DO MenuEnable</strong>
</p>

<p>
<strong>   OF ?SaveObjectBlob                        !Save object to BLOB</strong>
</p>

<p>
<strong>    SAV:Object{PROP:Handle} = ?AnyOLEObject{PROP:Blob}</strong>
</p>

<p>
<strong>    SAV:LinkType = &#039;B&#039;</strong>
</p>

<p>
<strong>    PUT(SaveLinks)</strong>
</p>

<p>
<strong>    IF ERRORCODE() THEN STOP(ERROR()) END</strong>
</p>

<p>
<strong>   OF ?SaveObjectFile                        !Save to OLE Compound Storage file</strong>
</p>

<p>
<strong>    ?AnyOLEObject{PROP:SaveAs} = &#039;TEST1.OLE\!Object&#039;</strong>
</p>

<p>
<strong>    SAV:LinkFile = &#039;TEST1.OLE\!Object&#039;</strong>
</p>

<p>
<strong>    SAV:LinkType = &#039;F&#039;</strong>
</p>

<p>
<strong>    PUT(SaveLinks)</strong>
</p>

<p>
<strong>    IF ERRORCODE() THEN STOP(ERROR()) END</strong>
</p>

<p>
<strong>   OF ?GetObject</strong>
</p>

<p>
<strong>    IF SAV:LinkType = &#039;F&#039;                    !Saved to OLE Compound Storage file?</strong>
</p>

<p>
<strong>     ?AnyOLEObject{PROP:Open} = SAV:LinkFile</strong>
</p>

<p>
<strong>    ELSIF SAV:LinkType = &#039;B&#039;                 !Saved to BLOB?</strong>
</p>

<p>
<strong>     ?AnyOLEObject{PROP:Blob} = SAV:Object{PROP:Handle}</strong>
</p>

<p>
<strong>    END</strong>
</p>

<p>
<strong>    DISPLAY</strong>
</p>

<p>
<strong>   OF ?ActiveExcel</strong>
</p>

<p>
<strong>    ?ExcelObject{PROP:DoVerb} = 0            !In-place activate Excel</strong>
</p>

<p>
<strong>   OF ?ActiveOLE</strong>
</p>

<p>
<strong>    ?AnyOLEObject{PROP:DoVerb} = 0           !Activate OLE Server in its default mode</strong>
</p>

<p>
<strong>   OF ?DeactExcel</strong>
</p>

<p>
<strong>    ?ExcelObject{PROP:Deactivate}            !Return to the Clarion application</strong>
</p>

<p>
<strong>   OF ?DeactOLE</strong>
</p>

<p>
<strong>    ?AnyOLEObject{PROP:Deactivate}           !Return to the Clarion application</strong>
</p>

<p>
<strong>   END !CASE FIELD()</strong>
</p>

<p>
<strong>  END  !CASE EVENT0()</strong>
</p>

<p>
<strong> END   !ACCEPT</strong>
</p>

<p>
<strong>BuildSheetData   ROUTINE                     !Use OLE Automation to build spreadsheet</strong>
</p>

<p>
<strong> ?ExcelObject{PROP:ReportException} = TRUE   !Excel will report any errors</strong>
</p>

<p>
<strong> ?ExcelObject{&#039;Application.Calculation&#039;} = xlManual  !turn off auto recalc</strong>
</p>

<p>
<strong> LOOP i = 1 TO 3                             !Fill Sheet with some values</strong>
</p>

<p>
<strong>  LOOP j = 1 TO 3</strong>
</p>

<p>
<strong>   ?ExcelObject{&#039;Cells(&#039; &amp;amp; i &amp;amp; &#039;,&#039; &amp;amp; j &amp;amp; &#039;).Value&#039;} = Random(100,900)</strong>
</p>

<p>
<strong>  END</strong>
</p>

<p>
<strong>  ?ExcelObject{&#039;Cells(4,&#039; &amp;amp; i &amp;amp; &#039;).Value&#039;} = &#039;Sum&#039;</strong>
</p>

<p>
<strong>  ?ExcelObject{&#039;Cells(5,&#039; &amp;amp; i &amp;amp; &#039;).FormulaR1C1&#039;} = &#039;=SUM(R[-4]C:R[-2]C)&#039;</strong>
</p>

<p>
<strong>  ?ExcelObject{&#039;Cells(6,&#039; &amp;amp; i &amp;amp; &#039;).Value&#039;} = &#039;Average&#039;</strong>
</p>

<p>
<strong>  ?ExcelObject{&#039;Cells(7,&#039; &amp;amp; i &amp;amp; &#039;).FormulaR1C1&#039;} = &#039;=AVERAGE(R[-6]C:R[-4]C)&#039;</strong>
</p>

<p>
<strong> END</strong>
</p>

<p>
<strong> !turn auto recalc back on</strong>
</p>

<p>
<strong> ?ExcelObject{&#039;Application.Calculation&#039;} = xlAutomatic</strong>
</p>

<p>
<strong> DISPLAY</strong>
</p>

<p>
<strong>MenuEnable  ROUTINE                          !Enable menu items</strong>
</p>

<p>
<strong>   ENABLE(?ActiveOLE)</strong>
</p>

<p>
<strong>   ENABLE(?SaveObjectBlob,?GetObject)</strong>
</p>

<p>
<strong>SelectOleServer PROCEDURE(OleQ PickQ)</strong>
</p>

<p>
<strong>window WINDOW(&#039;Choose OLE Server&#039;),AT(,,122,159),CENTER,SYSTEM,GRAY</strong>
</p>

<p>
<strong>        LIST,AT(11,8,100,120),USE(?List),HVSCROLL, |</strong>
</p>

<p>
<strong>        FORMAT(&#039;146L~Name~@s64@135L~CLSID~@s64@20L~ProgID~@s64@&#039;),FROM(PickQ)</strong>
</p>

<p>
<strong>        BUTTON(&#039;Select&#039;),AT(42,134),USE(?Select)</strong>
</p>

<p>
<strong>       END</strong>
</p>

<p>
<strong> CODE</strong>
</p>

<p>
<strong> OPEN(window)</strong>
</p>

<p>
<strong> SELECT(?List,1)</strong>
</p>

<p>
<strong> ACCEPT</strong>
</p>

<p>
<strong>  CASE ACCEPTED()</strong>
</p>

<p>
<strong>  OF ?Select</strong>
</p>

<p>
<strong>   GET(PickQ,CHOICE(?List))</strong>
</p>

<p>
<strong>   IF ERRORCODE() THEN STOP(ERROR()) END</strong>
</p>

<p>
<strong>   POST(EVENT:CloseWindow)</strong>
</p>

<p>
<strong>  END</strong>
</p>

<p>
<strong> END</strong>
</p>

<p>
<strong> RETURN(PickQ.ProgID)</strong>
</p>

<p>
<em class="u"><strong>Interface Properties</strong></em>
</p>
<div class="table sectionedit5"><table class="inline">
	<tr class="row0">
		<td class="col0"> PROP:Object </td><td class="col1"> Gets the Dispatch interface for the object. (READ ONLY) </td>
	</tr>
	<tr class="row1">
		<td class="col0 leftalign">  </td><td class="col1"> In VB the toolbar and tree control use the image-list control to show icons in the tree control and on the buttons on the toolbar. To associate an image control with a toolbar, use the following code: </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign">  </td><td class="col1"> <strong>?toolbar{&#039;ImageList&#039;} = ?imagelist{prop:object}</strong> </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign">  </td><td class="col1 leftalign">  </td>
	</tr>
	<tr class="row4">
		<td class="col0"> PROP:SelectInterface </td><td class="col1"> Selects the interface to use with the object. (WRITE ONLY) </td>
	</tr>
	<tr class="row5">
		<td class="col0 leftalign">  </td><td class="col1 leftalign">  </td>
	</tr>
	<tr class="row6">
		<td class="col0 leftalign">  </td><td class="col1"> <strong>?x{PROP:SelectInterface} = &#039;x.y&#039;</strong> </td>
	</tr>
	<tr class="row7">
		<td class="col0 leftalign">  </td><td class="col1"> <strong>?x{&#039;z(1)&#039;} = 1</strong> </td>
	</tr>
	<tr class="row8">
		<td class="col0 leftalign">  </td><td class="col1"> <strong>?x{&#039;z(2)&#039;} = 2</strong> </td>
	</tr>
	<tr class="row9">
		<td class="col0 leftalign">  </td><td class="col1 leftalign">  </td>
	</tr>
	<tr class="row10">
		<td class="col0 leftalign">  </td><td class="col1"> <strong>has the same meaning as</strong> </td>
	</tr>
	<tr class="row11">
		<td class="col0 leftalign">  </td><td class="col1 leftalign">  </td>
	</tr>
	<tr class="row12">
		<td class="col0 leftalign">  </td><td class="col1"> <strong>?x{&#039;x.y.z(1)&#039;} = 1</strong> </td>
	</tr>
	<tr class="row13">
		<td class="col0 leftalign">  </td><td class="col1"> <strong>?x{&#039;x.y.z(2)&#039;} = 2</strong> </td>
	</tr>
	<tr class="row14">
		<td class="col0 leftalign">  </td><td class="col1 leftalign">  </td>
	</tr>
	<tr class="row15">
		<td class="col0"> PROP:AddRef </td><td class="col1"> Increments the reference count for an interface. (WRITE ONLY) </td>
	</tr>
	<tr class="row16">
		<td class="col0"> PROP:Release </td><td class="col1"> Decrements the reference count for an interface. (WRITE ONLY) </td>
	</tr>
</table></div>

<p>
<em class="u"><strong>Clarion OLE/OCX library and object hierarchies:</strong></em>
</p>

<p>
At the time of the design and implementation of the Clarion OLE library, the lack of access to secondary objects created by a primary object (example from excel: ExcelUse{&#039;Application.Charts.Add&#039;}), was not considered a problem as there were other ways of accessing the object(ExcelUse {&#039;Application.Charts(Chart1).ChartWizard(&#039; &amp;amp;?ex{&#039;Range(A5:C5)&#039;}&amp;amp;&#039;,&#039;&amp;amp;xl3DPie&amp;amp;&#039;,7,1,0,0,2,,,,)&#039;})
</p>

<p>
At the time there was only one known instance where this was not the case. This is probably still true today as the OLE standard states that an object implement a collection, must also implement a method for accessing the objects by indexing.
</p>

<p>
Due to the special case mentioned above, when an object was created by one control and passed onto an other object as a parameter, a method which would be more or less transparent to the user, was implemented.
</p>

<p>
Calling a method which returns an IDispatchInterface is converted into a special representation (a &#039;`&#039; followed by a number of digits). This special representation is recognized in a couple of places in the OLE library.
</p>

<p>
The place that you will find most useful is, when the special representation is in the place where an interface could occur in the property syntax it will replace any previous interface in the access of the properties or methods of the object. For example:
</p>

<p>
<strong>x=y{&#039;charts.add()&#039;)</strong>
</p>

<p>
<strong>y{x&amp;amp;&#039;p(7)&#039;}</strong>
</p>

<p>
where y is an ole object and x is a cstring. This is an example of a method returning an interface and later this interface is used to access a method p with the parameter 7.
</p>

<p>
In this context a further complication arises form the reference counting used in OLE. Which means that if the object are used more than once it must have it&#039;s reference count increased before use.
</p>

<p>
<strong>x=y{&#039;charts.add()&#039;)</strong>
</p>

<p>
<strong>y{PROP:AddRef}=x</strong>
</p>

<p>
<strong>y{x&amp;amp;&#039;p(7)&#039;}</strong>
</p>

<p>
<strong>y{x&amp;amp;&#039;p(7)&#039;} ;last use of x</strong>
</p>

                    <!-- wikipage stop -->
                                    </div>

                <div class="docInfo"><bdi>ole_container_properties.htm.txt</bdi> · Last modified: 2021/04/15 15:57 (external edit)</div>

                            </div></div><!-- /content -->

            <hr class="a11y" />

            <!-- PAGE ACTIONS -->
            <div id="dokuwiki__pagetools">
                <h3 class="a11y">Page Tools</h3>
                <div class="tools">
                    <ul>
                        <li class="source"><a href="/doku.php?id=ole_container_properties.htm&amp;do=edit" title="Show pagesource [v]" rel="nofollow" accesskey="v"><span>Show pagesource</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M13 9h5.5L13 3.5V9M6 2h8l6 6v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4c0-1.11.89-2 2-2m.12 13.5l3.74 3.74 1.42-1.41-2.33-2.33 2.33-2.33-1.42-1.41-3.74 3.74m11.16 0l-3.74-3.74-1.42 1.41 2.33 2.33-2.33 2.33 1.42 1.41 3.74-3.74z"/></svg></a></li><li class="revs"><a href="/doku.php?id=ole_container_properties.htm&amp;do=revisions" title="Old revisions [o]" rel="nofollow" accesskey="o"><span>Old revisions</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M11 7v5.11l4.71 2.79.79-1.28-4-2.37V7m0-5C8.97 2 5.91 3.92 4.27 6.77L2 4.5V11h6.5L5.75 8.25C6.96 5.73 9.5 4 12.5 4a7.5 7.5 0 0 1 7.5 7.5 7.5 7.5 0 0 1-7.5 7.5c-3.27 0-6.03-2.09-7.06-5h-2.1c1.1 4.03 4.77 7 9.16 7 5.24 0 9.5-4.25 9.5-9.5A9.5 9.5 0 0 0 12.5 2z"/></svg></a></li><li class="backlink"><a href="/doku.php?id=ole_container_properties.htm&amp;do=backlink" title="Backlinks" rel="nofollow"><span>Backlinks</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M10.59 13.41c.41.39.41 1.03 0 1.42-.39.39-1.03.39-1.42 0a5.003 5.003 0 0 1 0-7.07l3.54-3.54a5.003 5.003 0 0 1 7.07 0 5.003 5.003 0 0 1 0 7.07l-1.49 1.49c.01-.82-.12-1.64-.4-2.42l.47-.48a2.982 2.982 0 0 0 0-4.24 2.982 2.982 0 0 0-4.24 0l-3.53 3.53a2.982 2.982 0 0 0 0 4.24m2.82-4.24c.39-.39 1.03-.39 1.42 0a5.003 5.003 0 0 1 0 7.07l-3.54 3.54a5.003 5.003 0 0 1-7.07 0 5.003 5.003 0 0 1 0-7.07l1.49-1.49c-.01.82.12 1.64.4 2.43l-.47.47a2.982 2.982 0 0 0 0 4.24 2.982 2.982 0 0 0 4.24 0l3.53-3.53a2.982 2.982 0 0 0 0-4.24.973.973 0 0 1 0-1.42z"/></svg></a></li><li class="top"><a href="#dokuwiki__top" title="Back to top [t]" rel="nofollow" accesskey="t"><span>Back to top</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg></a></li>                    </ul>
                </div>
            </div>
        </div><!-- /wrapper -->

        
<!-- ********** FOOTER ********** -->
<div id="dokuwiki__footer"><div class="pad">
    <div class="license">Except where otherwise noted, content on this wiki is licensed under the following license: <bdi><a href="http://creativecommons.org/licenses/by-sa/4.0/" rel="license" class="urlextern">CC Attribution-Share Alike 4.0 International</a></bdi></div>
    <div class="buttons">
        <a href="http://creativecommons.org/licenses/by-sa/4.0/" rel="license"><img src="/lib/images/license/button/cc-by-sa.png" alt="CC Attribution-Share Alike 4.0 International" /></a>        <a href="https://www.dokuwiki.org/donate" title="Donate" ><img
            src="/lib/tpl/dokuwiki/images/button-donate.gif" width="80" height="15" alt="Donate" /></a>
        <a href="https://php.net" title="Powered by PHP" ><img
            src="/lib/tpl/dokuwiki/images/button-php.gif" width="80" height="15" alt="Powered by PHP" /></a>
        <a href="//validator.w3.org/check/referer" title="Valid HTML5" ><img
            src="/lib/tpl/dokuwiki/images/button-html5.png" width="80" height="15" alt="Valid HTML5" /></a>
        <a href="//jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" ><img
            src="/lib/tpl/dokuwiki/images/button-css.png" width="80" height="15" alt="Valid CSS" /></a>
        <a href="https://dokuwiki.org/" title="Driven by DokuWiki" ><img
            src="/lib/tpl/dokuwiki/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" /></a>
    </div>
</div></div><!-- /footer -->

    </div></div><!-- /site -->

    <div class="no"><img src="/lib/exe/indexer.php?id=ole_container_properties.htm&amp;1631827331" width="2" height="1" alt="" /></div>
    <div id="screen__mode" class="no"></div></body>
</html>
